<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini Idea Vault</title>
    <!-- Tailwind CSS (CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 구글 폰트 (Google Fonts) -->
    <link
        href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Google+Sans:wght@400;500;700&display=swap"
        rel="stylesheet">
    <!-- 머티리얼 심볼 (Material Symbols) -->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Google Sans', 'Roboto', 'sans-serif'],
                    },
                    colors: {
                        gemini: {
                            blue: '#4285F4',
                            purple: '#A142F4', // 신비로운 느낌을 위해 조정됨
                            light: '#F8F9FA',
                        },
                        gold: {
                            500: '#FFD700',
                            600: '#D4AF37', // 메탈릭 골드
                            700: '#AA8C2C',
                            glow: 'rgba(255, 215, 0, 0.5)',
                        },
                        secure: {
                            bg: '#121212', // 보안 모드용 다크 배경
                            card: '#1E1E1E',
                            text: '#E0E0E0'
                        }
                    },
                    animation: {
                        'pulse-glow': 'pulse-glow 2s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'slide-up': 'slide-up 0.5s ease-out forwards',
                        'fade-in': 'fade-in 0.3s ease-out forwards',
                    },
                    keyframes: {
                        'pulse-glow': {
                            '0%, 100%': { boxShadow: '0 0 10px rgba(66, 133, 244, 0.5)' },
                            '50%': { boxShadow: '0 0 20px rgba(161, 66, 244, 0.8)' },
                        },
                        'slide-up': {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        },
                        'fade-in': {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        /* 커스텀 스크롤바 */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* 보안 모드 스타일 (Secure Mode Styles) */
        .secure-mode {
            background: radial-gradient(circle at top, #1e1e2f, #000000);
            color: #E0E0E0;
        }

        .secure-mode .header {
            border-bottom: 1px solid rgba(255, 215, 0, 0.2);
        }

        .secure-mode .patent-card {
            border: 1px solid #D4AF37;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.2);
            background: linear-gradient(135deg, #1a1a1a 0%, #252525 100%);
        }

        .secure-mode .user-bubble {
            background-color: #333;
            color: #fff;
        }

        .secure-mode .bot-bubble {
            background-color: transparent;
        }

        .secure-mode .gemini-gradient-text {
            background: linear-gradient(to right, #FFD700, #FDB931);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* 기본 모드 스타일 (Standard Mode Styles) */
        body {
            background-color: #F0F2F5;
            transition: background 0.5s ease, color 0.5s ease;
        }

        .user-bubble {
            background-color: #E3F2FD;
            /* 라이트 블루 */
            color: #1f2937;
        }

        .bot-bubble {
            background-color: transparent;
        }

        .gemini-gradient-text {
            background: linear-gradient(to right, #4285F4, #9B72CB, #D96570);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* 토글 스위치 (Toggle Switch) */
        .toggle-checkbox:checked {
            right: 0;
            border-color: #D4AF37;
        }

        .toggle-checkbox:checked+.toggle-label {
            background-color: #D4AF37;
        }

        /* 로딩 애니메이션 (Loading Animation) */
        .typing-dot {
            animation: typing 1.4s infinite ease-in-out both;
        }

        .typing-dot:nth-child(1) {
            animation-delay: -0.32s;
        }

        .typing-dot:nth-child(2) {
            animation-delay: -0.16s;
        }

        @keyframes typing {

            0%,
            80%,
            100% {
                transform: scale(0);
            }

            40% {
                transform: scale(1);
            }
        }

        /* 모달 오버레이 (Modal Overlay) */
        .modal-overlay {
            backdrop-filter: blur(5px);
        }
    </style>
</head>

<body class="h-screen flex flex-col font-sans transition-colors duration-500 relative overflow-hidden">

    <!-- 헤더 (Header) -->
    <header
        class="header flex justify-between items-center px-6 py-4 bg-white/80 backdrop-blur-md sticky top-0 z-50 transition-colors duration-500 dark:bg-black/50">
        <div class="flex items-center gap-2">
            <!-- 아이콘/로고 플레이스홀더 -->
            <span class="material-symbols-outlined text-3xl gemini-gradient-text select-none">lock_person</span>
            <h1 class="text-xl font-medium tracking-tight text-gray-800 dark:text-white">Gemini <span
                    class="gemini-gradient-text font-bold">Idea Vault</span></h1>
        </div>

        <!-- 모드 토글 (Mode Toggle) -->
        <div class="flex items-center gap-3">
            <label for="mode-toggle"
                class="text-sm font-medium text-gray-500 dark:text-gray-300 cursor-pointer select-none transition-colors text-right"
                id="mode-label">
                Contest Mode: <span class="font-bold text-gray-700 dark:text-gold-500">OFF</span>
            </label>
            <div
                class="relative inline-block w-12 align-middle select-none transition duration-200 ease-in flex-shrink-0">
                <input type="checkbox" name="toggle" id="mode-toggle"
                    class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer border-gray-300 checked:border-gold-600 checked:translate-x-6 left-0 top-0 transition-transform duration-300 ease-in-out z-10" />
                <label for="mode-toggle"
                    class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer transition-colors duration-300 ease-in-out"></label>
            </div>
        </div>
    </header>

    <!-- 메인 채팅 영역 (Main Chat Area) -->
    <main class="flex-1 overflow-y-auto w-full max-w-4xl mx-auto px-4 py-8 scroll-smooth" id="chat-container">
        <!-- 초기 환영 메시지 (Initial Greeting) -->
        <div class="flex flex-col items-center justify-center h-full text-center transition-opacity duration-500"
            id="welcome-message">
            <div
                class="mb-6 p-4 rounded-full bg-gradient-to-br from-blue-100 to-purple-100 dark:from-gray-800 dark:to-gray-700 shadow-lg">
                <span class="material-symbols-outlined text-6xl gemini-gradient-text">lightbulb</span>
            </div>
            <h2 class="text-3xl font-semibold mb-2 text-gray-800 dark:text-white">Protect your next big idea.</h2>
            <p class="text-gray-500 dark:text-gray-400 max-w-md">
                Securely chat with Gemini to instantly evaluate originality and draft provisional patent assets.
                <br><span class="text-xs mt-2 block opacity-70">(Toggle Contest Mode for enhanced protection)</span>
            </p>
        </div>

        <!-- 채팅 메시지가 여기에 추가됨 -->
        <div id="messages-list" class="flex flex-col gap-6 pb-24"></div>

    </main>

    <!-- 입력 영역 (Input Area) -->
    <footer
        class="w-full max-w-4xl mx-auto px-4 pb-6 pt-2 fixed bottom-0 left-0 right-0 z-40 bg-gradient-to-t from-white via-white to-transparent dark:from-black dark:via-black h-24 flex items-end justify-center transition-colors duration-500">
        <div
            class="relative w-full shadow-lg rounded-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 transition-all duration-300 focus-within:ring-2 focus-within:ring-blue-400 dark:focus-within:ring-gold-600 flex items-center pr-2 pl-6 py-3">
            <textarea id="user-input"
                class="flex-1 bg-transparent border-none outline-none text-gray-800 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 resize-none h-auto max-h-32 py-1"
                rows="1" placeholder="Describe your idea... (Shift+Enter for new line)" autocomplete="off"></textarea>
            <button id="send-btn"
                class="p-2 rounded-full text-gray-400 hover:text-blue-500 dark:hover:text-gold-500 transition-colors disabled:opacity-50">
                <span class="material-symbols-outlined">send</span>
            </button>
        </div>
    </footer>

    <!-- 법적 문서 모달 (Modal for Legal Doc) -->
    <div id="legal-modal" class="fixed inset-0 z-[60] hidden overflow-y-auto" aria-labelledby="modal-title"
        role="dialog" aria-modal="true">
        <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <!-- 배경 오버레이 (Background Overlay) -->
            <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity modal-overlay cursor-pointer"
                id="modal-backdrop"></div>

            <!-- 모달 패널 (Modal Panel) -->
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
            <div
                class="relative inline-block align-bottom bg-white dark:bg-gray-900 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full border border-gray-200 dark:border-gray-700">
                <div class="bg-white dark:bg-gray-900 px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                    <div class="sm:flex sm:items-start">
                        <div
                            class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 dark:bg-gray-800 sm:mx-0 sm:h-10 sm:w-10">
                            <span class="material-symbols-outlined text-blue-600 dark:text-gold-500">description</span>
                        </div>
                        <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full">
                            <h3 class="text-lg leading-6 font-medium text-gray-900 dark:text-white" id="modal-title">
                                Provisional Patent Application (US-2026-X892)
                            </h3>
                            <div
                                class="mt-2 text-sm text-gray-500 dark:text-gray-400 h-64 overflow-y-auto font-mono bg-gray-50 dark:bg-black p-4 rounded border dark:border-gray-800">
                                <p><strong>TITLE:</strong> SYSTEM AND METHOD FOR EMOTION VISUALIZATION APPARATUS</p>
                                <p class="mt-2"><strong>ABSTRACT:</strong></p>
                                <p>A wearable apparatus configured to detect physiological signals from a canine subject
                                    and translate said signals into visual indicators. The system comprises a biosensor
                                    array...</p>
                                <p class="mt-2"><strong>CLAIMS:</strong></p>
                                <ol class="list-decimal list-inside pl-2">
                                    <li>An apparatus comprising: a sensor unit configured to measure heart rate
                                        variability; a processor to interpret said variability as an emotional state...
                                    </li>
                                    <li>The apparatus of claim 1, further comprising an LED array wherein color
                                        correlates to specific emotional states...</li>
                                </ol>
                                <p class="mt-4 text-xs text-gray-400">Generated by Gemini Patent Agent v3.0.
                                    Confidential.</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="bg-gray-50 dark:bg-gray-800 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                    <button type="button" id="close-modal"
                        class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 dark:bg-gold-600 text-base font-medium text-white hover:bg-blue-700 dark:hover:bg-gold-700 focus:outline-none sm:ml-3 sm:w-auto sm:text-sm">
                        Download PDF
                    </button>
                    <button type="button" id="cancel-modal"
                        class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 dark:border-gray-600 shadow-sm px-4 py-2 bg-white dark:bg-gray-700 text-base font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 공유 모달 (Share Modal) -->
    <div id="share-modal" class="fixed inset-0 z-[60] hidden overflow-y-auto" aria-labelledby="share-modal-title"
        role="dialog" aria-modal="true">
        <div class="flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0">
            <!-- 배경 오버레이 -->
            <div class="fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75 modal-overlay cursor-pointer"
                id="share-modal-backdrop"></div>

            <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>

            <!-- 모달 패널 -->
            <div
                class="relative inline-block px-4 pt-5 pb-4 overflow-hidden text-left align-bottom transition-all transform bg-white border border-gray-200 shadow-xl dark:bg-gray-900 dark:border-gray-700 rounded-2xl sm:my-8 sm:align-middle sm:max-w-sm sm:w-full sm:p-6">
                <div>
                    <div
                        class="flex items-center justify-center w-12 h-12 mx-auto bg-blue-100 rounded-full dark:bg-gray-800">
                        <span class="material-symbols-outlined text-blue-600 dark:text-gold-500">share</span>
                    </div>
                    <div class="mt-3 text-center sm:mt-5">
                        <h3 class="text-lg font-medium leading-6 text-gray-900 dark:text-white" id="share-modal-title">
                            Share Patent Draft
                        </h3>
                        <div class="mt-4 grid grid-cols-1 gap-3">
                            <!-- Google Drive -->
                            <button
                                class="flex items-center justify-center w-full px-4 py-3 text-sm font-medium text-gray-700 transition-colors bg-white border border-gray-300 rounded-lg shadow-sm dark:bg-gray-800 dark:text-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700">
                                <img src="https://upload.wikimedia.org/wikipedia/commons/1/12/Google_Drive_icon_%282020%29.svg"
                                    alt="Google Drive" class="w-5 h-5 mr-3">
                                Save to Google Drive
                            </button>
                            <!-- Devpost -->
                            <button
                                class="flex items-center justify-center w-full px-4 py-3 text-sm font-medium text-gray-700 transition-colors bg-white border border-gray-300 rounded-lg shadow-sm dark:bg-gray-800 dark:text-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700">
                                <span
                                    class="w-5 h-5 mr-3 flex items-center justify-center font-bold text-white bg-[#003E54] rounded-sm text-[10px]">D</span>
                                Share to Devpost
                            </button>
                            <!-- GitHub -->
                            <button
                                class="flex items-center justify-center w-full px-4 py-3 text-sm font-medium text-gray-700 transition-colors bg-white border border-gray-300 rounded-lg shadow-sm dark:bg-gray-800 dark:text-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700">
                                <img src="https://upload.wikimedia.org/wikipedia/commons/c/c2/GitHub_Invertocat_Logo.svg"
                                    alt="GitHub" class="w-5 h-5 mr-3 dark:invert">
                                Push to GitHub
                            </button>
                        </div>
                    </div>
                </div>
                <div class="mt-5 sm:mt-6">
                    <button type="button" id="close-share-modal"
                        class="inline-flex justify-center w-full px-4 py-2 text-base font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm dark:bg-gray-700 dark:text-white dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none sm:text-sm">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 로직 (Logic) -->
    <script>
        const modeToggle = document.getElementById('mode-toggle');
        const modeLabel = document.getElementById('mode-label');
        const header = document.querySelector('header');
        const body = document.body;
        const chatContainer = document.getElementById('chat-container');
        const welcomeMessage = document.getElementById('welcome-message');
        const messagesList = document.getElementById('messages-list');
        const userInput = document.getElementById('user-input');
        const sendBtn = document.getElementById('send-btn');
        const footer = document.querySelector('footer');

        // 모달 요소 (Modal Elements)
        const modal = document.getElementById('legal-modal');
        const modalBackdrop = document.getElementById('modal-backdrop');
        const closeModalBtn = document.getElementById('close-modal');
        const cancelModalBtn = document.getElementById('cancel-modal');

        let isSecureMode = false;

        // 모드 토글 (Toggle Mode)
        modeToggle.addEventListener('change', () => {
            isSecureMode = modeToggle.checked;
            if (isSecureMode) {
                document.documentElement.classList.add('dark');
                body.classList.add('secure-mode');
                modeLabel.innerHTML = 'Contest Mode: <span class="font-bold text-gold-500">Hidden Gem (Patent Protection ON)</span>';
                // 다크 모드 전환을 위해 푸터 그라데이션 업데이트
                footer.classList.remove('from-white', 'via-white');
                footer.classList.add('from-black', 'via-black');
            } else {
                document.documentElement.classList.remove('dark');
                body.classList.remove('secure-mode');
                modeLabel.innerHTML = 'Contest Mode: <span class="font-bold text-gray-700">OFF</span>';
                // 푸터 그라데이션 업데이트
                footer.classList.add('from-white', 'via-white');
                footer.classList.remove('from-black', 'via-black');
            }
        });

        // 채팅 로직 (Chat Logic)
        function addMessage(content, isUser = false) {
            const wrapper = document.createElement('div');
            wrapper.className = `flex w-full ${isUser ? 'justify-end' : 'justify-start'} animate-slide-up`;

            const bubble = document.createElement('div');
            bubble.className = `max-w-[80%] px-5 py-3 rounded-2xl text-md leading-relaxed shadow-sm ${isUser
                ? 'user-bubble rounded-tr-none'
                : 'bot-bubble rounded-tl-none border border-gray-100 dark:border-gray-800 dark:text-gray-200'
                }`;

            if (!isUser) {
                // 봇 메시지는 HTML일 수 있음
                bubble.innerHTML = content;
            } else {
                bubble.textContent = content;
            }

            wrapper.appendChild(bubble);
            messagesList.appendChild(wrapper);

            // 바닥으로 스크롤
            const lastChild = messagesList.lastElementChild;
            lastChild.scrollIntoView({ behavior: 'smooth', block: 'end' });
        }

        function createLoader() {
            const wrapper = document.createElement('div');
            wrapper.id = 'loading-indicator';
            wrapper.className = 'flex w-full justify-start animate-fade-in my-2';

            const container = document.createElement('div');
            container.className = 'flex items-center gap-3 px-4 py-2';

            // 스피너/점 (Spinner/Dots)
            const dots = document.createElement('div');
            dots.className = 'flex space-x-1';
            dots.innerHTML = `
                <div class="w-2 h-2 bg-blue-500 rounded-full typing-dot"></div>
                <div class="w-2 h-2 bg-purple-500 rounded-full typing-dot"></div>
                <div class="w-2 h-2 bg-pink-500 rounded-full typing-dot"></div>
            `;

            // 상태 텍스트 (Status Text)
            const text = document.createElement('span');
            text.id = 'loading-text';
            text.className = 'text-sm font-medium text-gray-500 dark:text-gray-400 animate-pulse';
            text.textContent = 'Analyzing Originality...';

            container.appendChild(dots);
            container.appendChild(text);
            wrapper.appendChild(container);
            messagesList.appendChild(wrapper);

            return wrapper;
        }

        function createPatentCard() {
            const cardId = 'patent-card-' + Date.now();
            const cardHTML = `
                <div class="patent-card w-full max-w-md bg-white dark:bg-gray-800 rounded-xl overflow-hidden shadow-md mt-2 border border-blue-100 dark:border-gray-700 transition-all duration-300">
                    <!-- 카드 헤더 (Card Header) -->
                    <div class="bg-gradient-to-r from-blue-500 to-purple-600 dark:from-gold-600 dark:to-yellow-700 px-4 py-2 flex justify-between items-center">
                        <span class="text-white text-xs font-bold uppercase tracking-wider flex items-center gap-1">
                            <span class="material-symbols-outlined text-sm">verified</span> Provisional Patent
                        </span>
                        <span class="text-white/80 text-xs font-mono">US-2026-X892</span>
                    </div>
                    
                    <!-- 내용 (Content) -->
                    <div class="p-4">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <p class="text-xs text-gray-500 dark:text-gray-400 uppercase font-semibold">Gemini Score</p>
                                <div class="flex items-end gap-1">
                                    <span class="text-3xl font-bold gemini-gradient-text dark:text-gold-500">99</span>
                                    <span class="text-sm text-gray-400 mb-1">/100</span>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-xs text-gray-500 dark:text-gray-400 uppercase font-semibold">Est. Auction Value</p>
                                <p class="text-lg font-bold text-green-600 dark:text-green-400">$50k ~ $150k</p>
                            </div>
                        </div>

                        <div class="h-px bg-gray-100 dark:bg-gray-700 my-3"></div>
                        
                        <div class="flex gap-2">
                             <button onclick="openModal()" class="flex-1 bg-blue-50 hover:bg-blue-100 dark:bg-gray-700 dark:hover:bg-gray-600 text-blue-600 dark:text-gold-500 py-2 px-3 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-1">
                                <span class="material-symbols-outlined text-sm">gavel</span> View Legal Doc
                             </button>
                             <button onclick="openShareModal()" class="flex-none bg-gray-50 hover:bg-gray-100 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-400 py-2 px-3 rounded-lg transition-colors">
                                <span class="material-symbols-outlined text-sm">share</span>
                             </button>
                        </div>
                    </div>
                </div>
            `;
            return cardHTML;
        }

        async function handleSubmission() {
            const query = userInput.value.trim();
            if (!query) return;

            // 입력 초기화
            userInput.value = '';

            // 환영 메시지 숨김 처리
            if (welcomeMessage) {
                welcomeMessage.style.display = 'none';
            }

            // 1. 사용자 메시지 추가
            addMessage(query, true);

            // 2. 로딩 표시
            const loader = createLoader();
            const loadingText = loader.querySelector('#loading-text');

            // 바닥으로 스크롤
            loader.scrollIntoView({ behavior: 'smooth', block: 'end' });

            // 시뮬레이션 단계 (Simulation Steps)
            await new Promise(r => setTimeout(r, 1500));
            loadingText.textContent = 'Searching USPTO Database...';

            await new Promise(r => setTimeout(r, 1500));
            loadingText.textContent = 'Drafting Claims with Gemini 3.0 Pro...';

            await new Promise(r => setTimeout(r, 1500));

            // 3. 로더 제거 및 결과 표시
            loader.remove();

            const resultHTML = `
                <div class="animate-fade-in">
                    <p class="mb-2 text-gray-800 dark:text-gray-200">Processing complete. I've analyzed your concept and generated a provisional patent draft.</p>
                    ${createPatentCard()}
                </div>
            `;
            addMessage(resultHTML, false);
        }

        // Auto-resize textarea
        userInput.addEventListener('input', function () {
            this.style.height = 'auto';
            this.style.height = (this.scrollHeight) + 'px';
            if (this.value === '') this.style.height = 'auto';
        });

        userInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                handleSubmission();
                // Reset height after submission
                userInput.style.height = 'auto';
            }
        });

        sendBtn.addEventListener('click', handleSubmission);

        // 모달 로직 (Modal Logic)
        window.openModal = function () { // 인라인 onclick을 위해 window에 첨부
            modal.classList.remove('hidden');
            setTimeout(() => {
                modal.classList.add('opacity-100');
            }, 10);
        }

        function hideModal() {
            modal.classList.remove('opacity-100');
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300); // 트랜지션 대기
        }

        closeModalBtn.addEventListener('click', hideModal);
        cancelModalBtn.addEventListener('click', hideModal);
        modalBackdrop.addEventListener('click', hideModal);

        // 공유 모달 요소 (Share Modal Elements)
        const shareModal = document.getElementById('share-modal');
        const shareModalBackdrop = document.getElementById('share-modal-backdrop');
        const closeShareModalBtn = document.getElementById('close-share-modal');

        // 공유 모달 로직 (Share Modal Logic)
        window.openShareModal = function () {
            shareModal.classList.remove('hidden');
            setTimeout(() => {
                shareModal.classList.add('opacity-100');
            }, 10);
        }

        function hideShareModal() {
            shareModal.classList.remove('opacity-100');
            setTimeout(() => {
                shareModal.classList.add('hidden');
            }, 300);
        }

        closeShareModalBtn.addEventListener('click', hideShareModal);
        shareModalBackdrop.addEventListener('click', hideShareModal);

    </script>
</body>

</html>